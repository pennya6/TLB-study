
## 논문 제목 : A Survey on Deep Learning-based Anomaly Detection Models for Time Series Data(딥러닝을 활용한 시계열 자료의 이상치 탐지 모델에 대한 조사)  

논문 주저자 : 우요, 강준혁, 이재길

http://libproxy.hs.ac.kr/42493d2/_Lib_Proxy_Url_Https/www.dbpia.co.kr/journal/articleDetail?nodeId=NODE08763373

분석한 이 : 김시연

논문 선택 이유 : 딥러닝을 활용한 시계열 자료의 이상치 탐지 모델을 파악하기 위해서
 
### 들어가기 앞서  
  시계열 데이터란? 
  - 일정한 시간동안 수집된 일련의 순차적으로 정해진 데이터 셋의 집합
  - 특징 : 시간에 관해 순서가 매겨져 있다, 연속한 관측치는 서로 상관관계를 갖고 있다.
  - 시계열 데이터의 분석 목적 : 시계열이 갖고 있는 법칙성을 발견해 이를 모형화하고, 추정된 모형을 통하여 미래의 값을 예측한다.
  - 시계열 데이터를 볼때 유의할 점 : y축을 확인하여 노이즈 값에 영향을 많이 받는가를 확인해야한다.

### 요약  
  딥러닝은 최근 고차원적 및 복잡한 데이터를 처리하는 기술을 보여준다.  
  딥러닝기반의 이상 탐지 접근 방식이 대중화되어가고 있다.  
  본 논문에서는 <strong>예측기반, 재구성기반, 하이브리드 및 생성 모델과 같은 심층 이상 감지 모델</strong>을 소개한다.  

+ 소개  
  이상은 "다른 메커니즘에 의해 생성된 것처럼 나머지 개체와 크게 다른 데이터 개체"로 정의  
  이상탐지는 <strong>입력의 특성에 따라 순차적인 데이터에 대한 이상탐지</strong>와 <strong>비순차적 데이터에 대한 이상 탐지</strong>로 크게 분류할 수 있다.  
  본 논문에서는 순차적인 데이터인 시계열 데이터에 대한 이상탐지에 중점을 두고 있다.  
  
  
### 1) 예측 기반 모델 
  - 시계열 예측을 위한 가장 대표적인 예측 모델은 시퀀스 데이터 처리에 효과적인 <strong>RNN</strong>(Recurrent Neural Network)이다.  
  - 단 RNN은 그래디언트 소실 문제로 장기 종속성을 모델링하지 못한다. 따라서 <strong>LSTM</strong>이 개발되었다. 심층 이상 탐지 작업에서 자주 사용되며 시계열 데이터에서 잘 수행된다.
  - 비변칙적 센서을 통해 <strong>stacked LSTM network</strong>을 훈련하여 정상적인 시계열 동작을 모델링하고 예측한다.
  - 예측 오류는 <strong>다변량 가우시안 분포</strong>에 맞게 수집된다.
  -  모델은 4개의 데이터 셋으로 검증하였다. 
  -  미리 정의된 임계값을 사용하는 동안 발생할 수 있는 다양성, 비정류성 및 노이즈 문제를 처리하기 위해 <strong>비지도, 비모수, 동적 변칙 이상 임계값 접근 방식</strong>을 제안한다.
  -  동적으로 변화하고 비정상적인 환경에 적용 할 수 없으므로 데이터 분포의 변화에 적응하기 위해 <strong>online RNN 이상 탐지 모델</strong>이 도입되었다.
  -  위의 방법은 정상 데이터에 대해 RNN을 훈련하고 예측 오류에 대한 임계값을 설정하기 위해 레이블이 지정된 데이터만 필요하기 때문에 <strong>반지도 학습</strong>이다.
  -  단 외부요인으로 인해 시계열의 동작이 변경될때 예측기반 모델이 이러한 패턴을 포팍하지 못하고 성능이 저하될 수 있다.


### 2) 재구성 기반 모델
- <strong>Autoencoder</strong>는 재구성 기반 이상 탐지에 주로 사용된다. 이는 인코더, 디코더로 구성된 <strong>비지도 학습모델</strong>이다.
- 이상탐지에 오토인코더를 적용하는 아이디어의 기본 원리는 오토인코더가 훈련데이터가 충분하지만 보이지 않는 데이터를 재구성하는데 항상 실패하는 경우 <strong>입력을 잘 재구성 할 수 있다</strong>는 것이다.
- 다중센서 시계열 데이터에 대한 이상 탐지를 위해 LSTM기반의 <strong>Encoder-Decoder model</strong>을 제안한다.
- 인코더는 <strong>입력 시퀀스의 숨겨진 표현을 학습하도록 훈련</strong>되고 디코더는 <strong>잠재 벡터(latent vectors)를 기반으로 데이터를 재구성</strong>한다.
- 모델은 정상데이터에 대해서만 훈련이 되기 때문에 <strong>비정상 데이터을 잘 재구성 할 수 없다.</strong> 이는 이상값에 대한 재구성 오류가 정상 데이터보다 높아야 한다. 따라서 해당 시점의 <strong>재구성 오차를 기반으로 각 시간 스템에 대한 이상 확률을 추정</strong>할 수 있다.
- <strong>제한사항이 있다.</strong> 노이즈에 민감함으로 훈련 세트에 노이즈나 이상치가 있으면 오토인코더가 비정성 동작 모델링을 시작한다. 성능은 저하된다.
- <strong>오토인코더는 clean, noise-free training data을 요구</strong>한다.

![1](https://user-images.githubusercontent.com/53909511/128630408-4acd137f-2d4a-4d04-9111-e2e11da838e4.PNG)

### 3) 하이브리드 모델
- <strong>특징 추출에 딥러닝</strong> 방법을 사용하고 <strong>추출된 특징에 SVM과 같은 기계학습 이상치 탐지 알고리즘을 적용</strong>하였다.
- 고정길이 데이터 시퀀스만 처리할 수 있다는 문제점을 해결하기 위해서 <strong>가변길이 입력 시퀀스에 대한 LSTM 기반 이상 탐지 모델</strong>을 제안한다. 가변길이 시퀀스를 LSTM에 공급하고 고정길이 기능을 추출한 다음에 OC-SVM 기반 알고리즘을 적용하여 정상 데이터에서 이상을 분리하는 초평면을 찾는다. 또한 LSTM과 OC-SVM의 매개변수를 공동으로 최적화 할 수 있는 훈련 방법을 소개한다.

### 4) 생성 모델
- <strong>비지도 방식</strong>으로 데이터 분포를 학습하는데 효과적이다.
- 다양한 생성 신경망 중에서 <strong>VAE(variational autoencoder)</strong>는 일반적으로 사용되는 접근 방식으로 이상감지에 뛰어나다.
- 변칙 탐지에 적용할때 <strong>VAE는 정규데이터에 대해서만 훈련</strong>되며 정규데이터는 훈련 단계에서 학습된 분포를 따른다.
- 정상데이터의 재구성 확률은 임계값보다 낮을때 이상을 선언한다.
- 재구성 기반의 이상탐지 모델과 비교했을때 재구성 오류 대신에 <strong>이상 징후 지표로 재구성 확률</strong>을 제공한다는 장점이 있다.
- 단 VAE는 잠재공간에서 단일 모드 가우시안 분포를 가정함으로 다중모드 특성을 가진 다차원 시계열 데이터에 적합하지 않는다.
- 따라서 <strong>GRU 기반 가우시안 혼합 VAE 모델</strong>을 제안한다. 모델에서 시계열 간의 속성은 GRU(Gated Recurrent Unit)셀에 의해 모델링된다. 다중모드 데이터는 잠재공간에서 가우시안 혼합으로 특성화된다.

### 결론  
![2](https://user-images.githubusercontent.com/53909511/128631402-bebe6d12-3e3d-4e6f-a69c-ec2116eb2f76.PNG)

