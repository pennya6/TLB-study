### 논문 제목 : Variational Autoencoder를 이용한 데이터 및 지식기반 회전기기 이상 진단
### 논문 저자 : 서윤호, 마평식, 우정한, 선경한, 김병옥, 김봉석
### URL : https://doi.org/10.5050/KSNVE.2021.31.3.289
### 논문 선정 이유 : 진동 데이터를 이용한 이상 진단 사례이기 때문

### 1. 서론

   * Variational Autoencoder(VAE)  
    - 데이터를 기반으로 새로운 데이터를 생성하는 모델의 하나로, 학습 중 데이터의 차원을 축소하여 중요한 특징만을 자동적으로 추출하는 특징을 가짐.  
    - 입력/출력 데이터의 차이를 이용하여, 현재 데이터가 학습에 사용한 데이터와 얼마나 다른지 판단할 수 있음.  
    - 장점
        1) 정상 데이터만으로 이상 진단을 수행할 수 있음
        2) 손실 함수(입력과 출력의 차이)를 이상정수(anomaly score)로 정의하면, 다차원 데이터를 하나의 단일 지수로 변화하여 이상 진단 수행 가능

   * 본 논문에서는, VAE를 이용한 이상 진단의 절차를 설명하며, 이 때 이상 점수 정의 및 기준값 설정에 대하여 제안함.
   * 스팀 터빈 발전기에서 획득한 다채널 진동데이터를 이용하여, 제안된 이상 진단 기술을 적용하고 효용성을 보임.


### 2. VAE를 이용한 이상 진단

   * VAE 구성  
    - 인코더(encoder) : 다차원 통계적 데이터를 은닉 변수로 변환  
    - 디코더(decoder) : 은닉 변수를 다시 다차원의 데이터로 생성


   * VAE 특징  
      - 다차원 데이터를 작은 차원으로 압축하고 다시 확장함.  
      -> 데이터의 핵심적인 정보를 갖는 부분만을 남기는 필터링 역할을 할 수 있음.  
      -> 이를 이용하여 다차원 신호의 이상을 확인 가능.
     - 인코더, 디코더 부분은 가중치,절편,활성화 함수로 이루어진 신경망으로 근사화 하는 것이 일반적임.

       ![2](https://user-images.githubusercontent.com/63287424/128640290-6b71ef6f-af60-4e7b-a157-8dd714bebca9.PNG)
       
     - 학습 데이터를 이용하여 VAE를 학습하는 과정에서 분산을 변수로 선정하여 원하는 부분에 가중치 부여 가능
       -> 데이터에서 전문가가 원하는 요소들에 가중치를 부여해서, 해당 요소를 주요시 여기는 진단 모델 구축 가능.
       
     - 손실 함수의 값이 기준값 이상이 되면, 기계에 이상이 있다고 판단할 수 있음.
     - 기준값 선정은 기긱 상태, 외부 환경에 대한 고려가 필요함.
     
     
     
### 3. 스팀터빈 발전기 진동 특성

   * 데이터 측정 정보  
     - 측정 지점 : 각 부품의 베어링 부분  
     - 측정 물리량 : 진동 속도  
     - 측정 기간 : 1년(계절 변화가 미치는 영향 고려할 수 있도록)  
     - 진도 샘플링 주파수 : 25600Hz  
     - 데이터 획득 기간 중 발전량 : 30 MW 정격 운전 실시/감발(발전량 낮춤)/정지 구간 확인 가능  
     - 이상 진단 기법 검증을 위해, 정격 운전 구간 -> 정상 / 정격 이하의 발전 -> 이상으로 가정함.  

      ![5](https://user-images.githubusercontent.com/63287424/128640291-54653b0d-3337-4819-b8be-2641829f3958.PNG) 

    
    
   * VAE 입력/출력 데이터 : 측정 진동 데이터의 스펙트럼  
     - 측정된 raw data를 푸리에 변환을 통해 주파수 영역의 스펙트럼으로 변환함.
     - 여러 사항을 고려하여, 1 Hz 간겨의 주파수 해상도를 갖도록 데이터 처리 수행함.
     - VAE 학습 효율성 증가를 위해, 학습 데이터 중 최대값을 이용하여 정규화함.
     - 입력 61440개, 각각 2개의 층을 갖는 인코더와 디코더 , 출력 61440개
     - 활성화 함수 : softplus


   * 터빈 / 감속기 / 발전기의 진동 스펙트럼

     - 터빈 : 회전 속도의 1차 성분(113Hz), 4000 Hz 유동에 의한 광대역 진동, 기어 맞물림 주파수(4200Hz)의 축대역 성분이 작게 나타남.  
       ![6](https://user-images.githubusercontent.com/63287424/128640294-c9b93b77-a816-4b8a-8fb2-1e937f98e84b.PNG)
     
     - 감속기 : 기어 맞물림 주파수(4200 Hz) 성분이 지배적으로 나타남.

       ![7](https://user-images.githubusercontent.com/63287424/128640295-48c1e4f7-dc7d-4c0b-a937-52ab574a43e3.PNG)
     
     - 발전기 : 회전 속도의 1차(30Hz), 2차(60Hz) 성분

       ![8](https://user-images.githubusercontent.com/63287424/128640296-45617a29-fb65-4c32-b621-ebc102957807.PNG)
     
    
### 4. 스팀터빈 발전기 이상 진단

   * 정상 데이터를 이용하여 학습한 후, 학습 데이터의 이상 점수(손실 함수 값)  
     ![9](https://user-images.githubusercontent.com/63287424/128640297-77c0c4e5-7b87-46c9-8c03-fb03061fdb29.PNG)
     
   * 기기 운전 조건의 미세한 변화에 의하여, 아래와 같은 분포를 갖게됨.
     - 다양한 확률 분포의 특성이 반영 가능한 편향된 정규 분포의 형태의 Pearson type3의 확률 분포 함수로 곡선 맞춤을 실시함.
     - 이상 진단의 보수적인 접근을 위하여, 누적 확률 분포가 99% 이상인 지점을 이상 기준값으로 사용함.
       ![10](https://user-images.githubusercontent.com/63287424/128640298-99fb9265-ca05-466e-97fe-423e7c4aecc4.PNG)
       
   * Test data : 2018년 정지 및 감발 상태 데이터 + 학습 데이터와 다른 기간의 정상 데이터
     - 정확도 94.5% 로 이상 진단이 이루어졌음을 확인.  
       ![11](https://user-images.githubusercontent.com/63287424/128640302-5ff09938-2c04-466a-85bf-ea047a9a2cbf.PNG)
     - 정상->이상으로 분류는 극히 적고, 이상->정상으로 판단하는 경우가 많음.  
       이는 감발의 정도에 따라 정상과 유사한 상태가 존재하기 때문으로 판단됨.  
       ![55](https://user-images.githubusercontent.com/63287424/128640303-11407aa6-7f44-42f3-9df9-06b8b71d8ef0.PNG)
       
   * 분산 값을 변경하여 학습하는 예
     - 센서 이상 현상 발생  
     
       ![12](https://user-images.githubusercontent.com/63287424/128640304-948ce17d-2031-4c9b-86d7-613f3f33c580.PNG)
![13](https://user-images.githubusercontent.com/63287424/128640306-af76c2aa-52ca-4469-9079-cfffc6c75990.PNG)
![14](https://user-images.githubusercontent.com/63287424/128640308-ce60440d-2492-4504-a5a4-1769260a4294.PNG)

     - 적게 측정된 기어 맞물림 주파수 영역의 분산을 변경하여 가중치를 높여 학습함.  
     
      ![15](https://user-images.githubusercontent.com/63287424/128640312-885b696e-0033-4850-9601-a9334ca362b5.PNG)
![16](https://user-images.githubusercontent.com/63287424/128640313-9a3cd9c4-8653-42f8-a8d8-29a124f7c9fc.PNG)

     - 발전 정지되 상태는 가중치가 달라져도 이상점수가 유사한 수준으로 나타나지만,
     - 감발 운전의 경우 가중치 부여에 따라 다른 이상 저수를 나타냄.


### 5. 결론

   * VAE 구조를 이용하여 기계시스템의 이상을 진단하는 기술을 제안함
   * 조기 경보 및 잔여 수명 예측으로도 응용 가능할 것으로 기대됨.
