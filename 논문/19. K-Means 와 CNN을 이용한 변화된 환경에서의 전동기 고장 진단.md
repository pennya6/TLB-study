# K-Means 와 CNN을 이용한 변화된 환경에서의 전동기 고장 진단
- **논문 제목** : K-Means 와 CNN을 이용한 변화된 환경에서의 전동기 고장 진단

- 논문 저자 : 최동진, 한지훈, 박상욱, 홍선기
- 논문 리뷰자 : 노지영
- 논문 출처 : https://www.dbpia.co.kr/Journal/articleDetail?nodeId=NODE09331901

- 논문 선정 이유 :


## 서론 
-  `CNN` : 객체를 추출하는 알고리즘에서 높은 성능을 보여줌, 실시간 동영상에서 특정한 객체를 추적하기 위해서는 CNN에 칼만필터를 적용함 
-  그러나, 고장진단에서는 사진에서 원하는 객체를 얻어내는 것이 목적이 아닌 파형 전체를 확인하는 과정이 필요하기 때문에 기존의 CNN알고리즘의 목적과 다름 
-  또, CNN은 지도학습 기반임. 그래서 데이터를 수집한다고 하더라도, 데이터 라베링을 사람이 직접해야하는 단점이 존재
-  본 논문에서는 `비지도 학습`을 이용한 `군집화`를 이용하여 데이터를 자동으로 분류 및 라벨링하여 `CNN의 학습데이터`로 사용하는 방법을 제안함
-  군집화 알고리즘을 통해 분류된 데이터에 `라벨링`을 하여 학습에 사용함. -> 지도학습의 단점인 라벨링을 사람이 직접 해야한다는 단점을 보안할 수 있다. 
-  그러나, `비지도학습`방법은 기존의 `지도학습`을 이용한 방법에 비해서 `정확도`가 `감소`한다는 단점이 있음
-  때문에 비지도학습을 이용하여 데이터를 분류하고, 분류된 데이터를 지도학습의 학습데이터로 사용하여 정확도를 보완하는 방법을 제안.
 
## 지도학습을 이용한 고장진단
1. 지도학습을 이용한 방법 
- 전동기 고장에 대한 `주파수별` 데이터에 관해 서술한 논문 -> "Time-Frequency analysis for efficient fault diagnosis and failure prognosis for interior permanent-magnet AC motors"
- 전동기 고장에서는 `FFT`된 데이터를 이용함.
- `그림 1 (a), (b)`는 `정상` 데이터, `그림 1 (c), (d)`는 `고장` 데이터임.
- (a),(c) 는 10Hz의 전동기 구동 주파수에서 측정한 결과 (b), (d)는 40Hz의 구동 주파수에서 수집한 데이터
  ![image](https://user-images.githubusercontent.com/51046701/128641952-e1a6f4d1-11ca-45ce-8572-d4285d32b2c3.png)



- 그림 2는 CNN을 이용한 고장진단 알고리즘. 
![image](https://user-images.githubusercontent.com/51046701/128642025-f15a13dd-54bd-4020-87dd-75dca63fcb23.png)


2. 지도학습을 이용한 방법의 문제점
- 그림 3은 각각 다른 센서를 이용하여 수집된 진동 데이터 
- 두 데이터는 같은 환경에서 센서만 변경하였을 때 수집된데이터이다. 
- 센서 1에는 아이솔레이터터가 장착된 모델이고, 센서2는 없는 모델이다. 그래서 그래프 상으로 보았을 때 차이가 발생하는 것으로 보인다. 
- 하지만 센서 2(그림 3(b),(d))를 보면 50, 100, 150 마다 주원주파수가 데이터에 나타남.
- 따라서 센서 1과 센서 2는 비슷한 패턴을 보이고 있음. 하지만 CNN을 사용할 경우 이미지 자체의 특징값만을 뽑아내는것에 주력하다보니 두 데이터를 완전히 다른 데이터로 판단한다.
![image](https://user-images.githubusercontent.com/51046701/128640845-c6b6d057-1b1b-4621-9163-20f87a6865eb.png) ![image](https://user-images.githubusercontent.com/51046701/128640793-2750a5fa-6930-437a-b7d7-f8e20931ea8f.png)

## 비지도 학습을 이용한 고장진단
 1. k-means
 : 대표적인 군집화 알고리즘. 군집마다 하나의 중심(centroid)를 가진다. 
 각 데이터는 가장 가까운 중심에 할당되고, 같은 중심에 할당된 데이터들이 모여 군집을 형성한다. (+사용자가 사전에 군집수(K)를 정해야함)
 
 2. K-means 비지도 학습을 이용한 검증 방법 
 : k-means를 바로 고장 진단에 사용할 수 없다. K-means는 n개의 d-차원의 데이터까지 처리가 가능하지만 FFT된 데이터처럼 연속적인 데이터 처리는 불가능하다.
** 때문에 시간영역의 데이터 또는 FFT같은 연속적인 데이터는 다른 처리 방법이 필요하다**
-> 주파수 별로 k-means를 적용함 그러면 그림4의 b의 모습으로 클러스터링됨
- k-means는 데이터의 정답을 알 수 없는 비지도 학습이기 때문에 데이터를 분류하여도 어떤 데이터가 고장, 정상인지 알 수 없음.
- 또 데이터를 주파수 별로 분류하였기 때문에 주파수 별로 어떠한 데이터가 고장, 정상 데이터인지 알 수 없다. 
- 그러나 고장 진단을 수행하려면 주파수 별로 데이터가 고장에 가까운 데이터인지, 정상에 가까운 데이터인지 알아야한다. -> 최종적으로 그림 4의 c와 같이 클러스터링되어야한다.
![image](https://user-images.githubusercontent.com/51046701/128640884-bbcd24b0-7d6c-4a9b-9d54-81474aa4ce80.png)
- 그림 5의 (a)는 센서 1의 데이터를 주파수 별로 k-means를 적용하여 분류한 결과.
- 데이터는 주파수 별로 2개의 K1, K2로 분류됨 (하지만, 고장과 정상에 대한 정보는 없는 상태) 이를 해결하기 위해 분류된 중심점 데이터와 입력데이터를 비교한다. 
- 그림 4의 c와 같이 그림 5의 b처럼 정상 군집의 중심점, 고장 군집의 중심점 데이터로 분류할 수 있다.
![image](https://user-images.githubusercontent.com/51046701/128641198-a2a0de2a-9d57-4556-9838-87065f9c578a.png)

-> k-means를 사용하였지만, 중간 과정에 데이터에 정답을 부여하는 라벨링이 들어가고, 라벨링된 데이터를 이용하여 다른 데이터를 판별한다. 따라서 소량의 모표값을 포함하는 데이터가 입력되기 때문에 정확하게는 비지도학습이 아닌 준지도학습의 일종으로 볼 수 도 있다고함.
-> 완전 비지도학습법에 비해 높은 정확도를 보임
-> 또한 비지도 학습인 오토인코더에 비해서 알고리즘 적으로 쉽고 계산량이 적다는 장점이 있음 .

3. 데이터 전처리 
-> FFT를 사용했다고 함
4. K-means 비지도 학습을 이용한 실험 
![image](https://user-images.githubusercontent.com/51046701/128641393-6dce7112-e527-4a55-8f84-609837990c1b.png)
![image](https://user-images.githubusercontent.com/51046701/128641410-86e374c2-c92f-4b7f-b4c2-68039148748d.png)
![image](https://user-images.githubusercontent.com/51046701/128641423-f4da8c8c-7d47-4036-94ff-3ec013d64828.png)

5. k-means 비지도 학습을 이용한 한계점
장점 1) 학습되지않은데이터를 잘 분류해내고 별도의 라벨링 과정 없이 사용할 수 있다는 장점 존재 
단점 -> 표3의 결과를 보면 CNN과 K-means는 검증 정도의 차이가 나는 것을 확인할 수 있음 (CNN이 더 정확도가 높다는 말) : 이 결과는 지도학습이 학습된 데이터에 한해서는 꽤나 높은 정확도를 보이기 때문 

## 비지도 학습과 지도학습을 모두 이용한 방법 
1. k-means와 CNN을 이용한 고장진단
![image](https://user-images.githubusercontent.com/51046701/128641614-80f13d8d-7ef2-476a-9d0e-14d63c9516db.png)

## 결론 
- k-means와 CNN을 이용한 고장 진단 모델은 사용자가 고려하지 못한 데이터가 입력되더라도, 높은 정확도를 보여주었고, 기존의 분류된 데이터에서도 높은 결과를 보여줌. 
- 해당 방법은 다양한 환경에서의 전동기의 고장진단이 가능하고, 사용자가 고려하지 못한 데이터가 입력되더라도 학습된 데이터와 비슷한 패턴의 데이터라면 검증이 가능하다 .
- 고려도니 ㄷ
